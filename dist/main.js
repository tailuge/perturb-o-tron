!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).bundle=e()}}(function(){return function s(r,u,c){function f(t,e){if(!u[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(p)return p(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var i=u[t]={exports:{}};r[t][0].call(i.exports,function(e){return f(r[t][1][e]||e)},i,i.exports,s,r,u,c)}return u[t].exports}for(var p="function"==typeof require&&require,e=0;e<c.length;e++)f(c[e]);return f}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function n(e){this.event=e}return n.prototype.isComplete=function(){return!!n.completePattern.exec(this.event)},n.prototype.score=function(e){var t=n.matePattern.exec(this.event);return t?this.scoreMate(e,t[1]):(t=n.centipawnPattern.exec(this.event))?this.scoreCp(e,t[1]):"noScore"},n.prototype.scoreCp=function(e,t){return t<250&&-250<t?"drawn":e.includes("w")?0<t?"whiteWin":"blackWin":t<0?"whiteWin":"blackWin"},n.prototype.scoreMate=function(e,t){return e.includes("w")?t.includes("-")?"blackWin":"whiteWin":t.includes("-")?"whiteWin":"blackWin"},n.matePattern=/score mate ([^ ]*) .*/,n.centipawnPattern=/score cp ([^ ]*) .*/,n.completePattern=/bestmove.*/,n}();n.Event=o},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./stockfishqueue");n.StockfishQueue=o.StockfishQueue},{"./stockfishqueue":3}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("./event"),o=function(e,t){this.fen=e,this.onComplete=t},s=function(){function e(e,t){var n=this;this.workItems=[],this.stockfish=e,this.log=t,this.stockfish.postMessage("setoption name MultiPV value 1"),this.stockfish.addEventListener("message",function(e){n.sfEventHandler(e.data)})}return e.prototype.sfEventHandler=function(e){this.log(e);var t=new i.Event(e);if(t.isComplete()){this.log("complete");var n=this.workItems.shift();return n&&n.onComplete(n.score),void(0<this.workItems.length&&this.processNextWorkItem())}var o=t.score(this.workItems[0].fen);if("noScore"!=o)return this.workItems[0].score=o,void this.log("parsed as "+o);this.log("ignored")},e.prototype.enqueue=function(e,t){this.workItems.push(new o(e,t)),1==this.workItems.length&&this.processNextWorkItem()},e.prototype.processNextWorkItem=function(){var e=this.workItems[0].fen;this.log("sending fen to stockfish for scoring : "+e),this.stockfish.postMessage("position fen "+e),this.stockfish.postMessage("go depth 8")},e}();n.StockfishQueue=s},{"./event":1}]},{},[2])(2)});